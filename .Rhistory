ggplot(new_df[!is.na(new_df$BorrowerRate), ],
aes(x = LoanStatus2, y = BorrowerRate))+
geom_boxplot()+
coord_flip()+
ggtitle("Delinquency distribution by loan status")+
Theme1
ggplot(df[!is.na(df$BorrowerRate), ],
aes(x = LoanStatus, y = BorrowerRate))+
geom_boxplot()+
coord_flip()+
ggtitle("Delinquency distribution by loan status")+
Theme1
df$BorrowerRate <- as.factor(df$BorrowerRate)
ggplot(df[!is.na(df$BorrowerRate), ],
aes(x = LoanStatus, y = BorrowerRate))+
geom_boxplot()+
coord_flip()+
ggtitle("Delinquency distribution by loan status")+
Theme1
summary(df$BorrowerRate)
df$BorrowerAPR <- as.factor(df$BorrowerAPR)
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = LoanStatus, y = BorrowerAPR))+
geom_boxplot()+
coord_flip()+
ggtitle("Delinquency distribution by loan status")+
Theme1
df$BorrowerAPR <- as.factor(df$BorrowerAPR)
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = LoanStatus, y = BorrowerAPR))+
geom_boxplot()+
coord_flip()+
ggtitle("Delinquency distribution by loan status")+
Theme1
df <- data_frame[,c("Term",
"LoanStatus",
"BorrowerAPR",
"ProsperScore",
"ListingCategory..numeric.",
"Occupation",
"EmploymentStatus",
"CreditScoreRangeLower",
"CreditScoreRangeUpper",
"AmountDelinquent",
"DelinquenciesLast7Years",
"IncomeVerifiable",
"StatedMonthlyIncome",
"LoanOriginalAmount") ]
names(df)[names(df)=="ListingCategory..numeric."] <- "ListingCategory"
df$CreditScore <-  (df$CreditScoreRangeLower + df$CreditScoreRangeUpper) /2
df$Category[df$ListingCategory == "0"] <-
"Not Available"
df$Category[df$ListingCategory == "1"] <-
"Debt Consolidation"
df$Category[df$ListingCategory == "2"] <-
"Home Improvement"
df$Category[df$ListingCategory == "3"] <-
"Business"
df$Category[df$ListingCategory == "4"] <-
"Personal Loan"
df$Category[df$ListingCategory == "5"] <-
"Student Use"
df$Category[df$ListingCategory == "6"] <-
"Auto"
df$Category[df$ListingCategory == "7"] <-
"Other"
df$Category[df$ListingCategory == "8"] <-
"Baby&Adoption"
df$Category[df$ListingCategory == "9"] <-
"Boat"
df$Category[df$ListingCategory == "10"] <-
"Cosmetic Procedure"
df$Category[df$ListingCategory == "11"] <-
"Engagement Ring"
df$Category[df$ListingCategory == "12"] <-
"Green Loans"
df$Category[df$ListingCategory == "13"] <-
"Household Expenses"
df$Category[df$ListingCategory == "14"] <-
"Large Purchases"
df$Category[df$ListingCategory == "15"] <-
"Medical/Dental"
df$Category[df$ListingCategory == "16"] <-
"Motorcycle"
df$Category[df$ListingCategory == "17"] <-
"RV"
df$Category[df$ListingCategory == "18"] <-
"Taxes"
df$Category[df$ListingCategory == "19"] <-
"Vacation"
df$Category[df$ListingCategory == "20"] <-
"Wedding Loans"
df$LoanStatus <- as.factor(df$LoanStatus)
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = LoanStatus, y = BorrowerAPR))+
geom_boxplot()+
coord_flip()+
ggtitle("")+
Theme1
names(df)
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = BorrowerAPR, y = LoanOriginalAmount))+
geom_point()+
ggtitle("Borrower's APR distribution with different loan status")+
Theme1
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = BorrowerAPR, y = LoanOriginalAmount))+
geom_point(alpha = 0.1,
position = position_jitter(width = 0.005,
height = 300))+
ggtitle("Borrower's APR distribution with different loan status")+
Theme1
ggplot(df[!is.na(df$CreditScore), ],
aes(x = CreditScore, y = LoanOriginalAmount))+
geom_point(alpha = 0.05)+
ggtitle("")+
Theme1
ggplot(df[!is.na(df$CreditScore), ],
aes(x = CreditScore, y = BorrowerAPR))+
geom_point(alpha = 0.05,
position = position_jitter(width = 5,
height = 0.005))+
ggtitle("")+
Theme1
ggplot(df[!is.na(df$CreditScore), ],
aes(x = CreditScore, y = BorrowerAPR))+
geom_point(alpha = 0.05,
position = position_jitter(width = 5,
height = 0.005))+
ggtitle("")+
Theme1
ggplot(df[!is.na(df$CreditScore), ],
aes(x = CreditScore, y = BorrowerAPR))+
geom_point(alpha = 0.02,
position = position_jitter(width = 7,
height = 0.005))+
ggtitle("")+
Theme1
ggplot(df[!is.na(df$CreditScore), ],
aes(x = CreditScore, y = BorrowerAPR))+
geom_point(alpha = 0.02,
position = position_jitter(width = 7,
height = 0.005))+
geom_smooth(method = "lm", se = FALSE)
ggtitle("")+
Theme1
ggplot(df[!is.na(df$CreditScore), ],
aes(x = CreditScore, y = BorrowerAPR))+
geom_point(alpha = 0.02,
position = position_jitter(width = 7,
height = 0.005))+
geom_smooth(method = "lm", se = FALSE)+
ggtitle("")+
Theme1
ggplot(df[!is.na(df$CreditScore) & (df$CreditScore > 20), ],
aes(x = CreditScore, y = BorrowerAPR))+
geom_point(alpha = 0.02,
position = position_jitter(width = 7,
height = 0.005))+
geom_smooth(method = "lm", se = FALSE)+
ggtitle("")+
Theme1
ggplot(df[!is.na(df$CreditScore) & (df$CreditScore > 20), ],
aes(x = CreditScore, y = BorrowerAPR))+
geom_point(alpha = 0.02,
shape = ".",
position = position_jitter(width = 7,
height = 0.005))+
geom_smooth(method = "lm", se = FALSE)+
ggtitle("")+
Theme1
kk
ggplot(df[!is.na(df$CreditScore) & (df$CreditScore > 20), ],
aes(x = CreditScore, y = BorrowerAPR))+
geom_point(alpha = 0.1,
shape = ".",
position = position_jitter(width = 7,
height = 0.005))+
geom_smooth(method = "lm", se = FALSE)+
ggtitle("")+
Theme1
ggplot(df[!is.na(df$CreditScore) & (df$CreditScore > 20), ],
aes(x = CreditScore, y = BorrowerAPR))+
geom_point(alpha = 0.3,
shape = ".",
position = position_jitter(width = 10,
height = 0.005))+
geom_smooth(method = "lm", se = FALSE)+
ggtitle("")+
Theme1
names(df)
ggpairs(df[, c(BorrowerAPR, CreditScore , StatedMonthlyIncome)])
library(GGally)
ggpairs(df[, c(BorrowerAPR, CreditScore , StatedMonthlyIncome)])
ggpairs(df[, c("BorrowerAPR", "CreditScore" , "StatedMonthlyIncome")])
summary(df$CreditScore)
df2 <- df[!is.na(df$CreditScore) & (df$CreditScore != 9.5),]
ggplot(df2,
aes(x = CreditScore)) +
geom_histogram(binwidth = 10)+
ggtitle("Credit score distribution")+
Theme1
quantile(df$StatedMonthlyIncome, 0.9999)
quantile(df$StatedMonthlyIncome, 0.999)
quantile(df$StatedMonthlyIncome, 0.995)
sum(is.na(df$DelinquenciesLast7Years))
sum(is.na(df$LoanOriginalAmount))
sum(is.na(df$BorrowerAPR))
df2 <- df[!is.na(df$BorrowerAPR) &
!is.na(df$CreditScore) &
df$CreditScore != 9.5 &
!is.na(df$DelinquenciesLast7Years) &
!is.na(df$AmountDelinquent) &
(df$StatedMonthlyIncome <=
quantile(df$StatedMonthlyIncome0.995)), ]
df2 <- df[!is.na(df$BorrowerAPR) &
!is.na(df$CreditScore) &
df$CreditScore != 9.5 &
!is.na(df$DelinquenciesLast7Years) &
!is.na(df$AmountDelinquent) &
(df$StatedMonthlyIncome <=
quantile(df$StatedMonthlyIncome, 0.995)), ]
nrow(df2)
ggpairs(df2[, c("BorrowerAPR", "CreditScore" , "StatedMonthlyIncome", "LoanOriginalAmount", "AmountDelinquent", "DelinquenciesLast7Years")])
new_df2 <- new_df[!is.na(new_df$ProsperScore) &
!is.na(new_df$CreditScore), ]
new_df2$CreditScore2 <- cut2(new_df2$CreditScore, g = 20)
new_df2$ProsperScore2 <- cut2(new_df2$ProsperScore, g = 20)
new_df3 <- new_df2 %>% group_by(CreditScore2, ProsperScore2) %>%
summarise(good_debt_ratio =
ratio(LoanStatus2,
"Good_debt"))
ggplot(new_df3,
aes(x=CreditScore2,y=ProsperScore2))+
geom_tile(aes(fill = good_debt_ratio))+
scale_fill_gradient(low = "black", high = "yellow")+
ggtitle("Heat map of CreditScore and ProsperScore")+
Theme1
new_df2 <- new_df[new_df$StatedMonthlyIncome <= 25000,]
ggplot(new_df2,
aes(x = LoanStatus2, y = StatedMonthlyIncome))+
geom_boxplot()+
coord_flip()+
ggtitle("Delinquency distribution by loan status")+
Theme1
ggplot(data=mtcars, aes(x=hp)) + geom_line(aes(fill=..count..), stat="bin", binwidth=10)
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
geom_line(aes(fill=..count..))+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
#geom_bar(position =  "fill")+
geom_line(aes(fill=..count..))+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
#geom_bar(position =  "fill")+
geom_line(aes(fill=..count..), stat="bin")+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
#geom_bar(position =  "fill")+
geom_freqpoly()+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
geom_freqpoly()+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
new_df$Term <- as.factor(new_df$Term)
new_df$Term <- as.factor(new_df$Term)
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
new_df$Term <- as.factor(new_df$Term)
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
geom_freqpoly()+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
new_df$Term <- as.factor(new_df$Term)
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
geom_freqpoly(stat="count")+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
new_df$Term <- as.factor(new_df$Term)
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
df$LoanStatus <- as.factor(df$LoanStatus)
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = LoanStatus, y = BorrowerAPR))+
geom_boxplot()+
coord_flip()+
ggtitle("Borrower's APR distribution with different loan status")+
Theme1
length(df[!is.na(df$BorrowerAPR) & df$LoanStatus == "Completed", ]
$LoanStatus)
length(df[!is.na(df$BorrowerAPR) & df$LoanStatus == "Completed", ]
$LoanStatus)
length(df[!is.na(df$BorrowerAPR) & df$LoanStatus == "Chargedoff", ]
$LoanStatus)
x <- df[!is.na(df$BorrowerAPR) & df$LoanStatus == "Completed", ]
$LoanStatus
x <- df[!is.na(df$BorrowerAPR) & df$LoanStatus == "Completed", ]$
LoanStatus
y <- df[!is.na(df$BorrowerAPR) & df$LoanStatus == "Chargedoff", ]$
LoanStatus
t.test(x,y,mu = 0)
x <- df[!is.na(df$BorrowerAPR) & df$LoanStatus == "Completed", ]$
BorrowerAPR
y <- df[!is.na(df$BorrowerAPR) & df$LoanStatus == "Chargedoff", ]$
BorrowerAPR
t.test(x,y,mu = 0)
df$LoanStatus <- as.factor(df$LoanStatus)
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = LoanStatus, y = BorrowerAPR))+
geom_boxplot()+
coord_flip()+
ggtitle("Borrower's APR distribution with different loan status")+
scale_fill_continuous(guide = guide_legend(title = "test))+
Theme1
sac
qq
)
!
q
wxit
))
)))
""
df$LoanStatus <- as.factor(df$LoanStatus)
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = LoanStatus, y = BorrowerAPR))+
geom_boxplot()+
coord_flip()+
ggtitle("Borrower's APR distribution with different loan status")+
Theme1
df$LoanStatus <- as.factor(df$LoanStatus)
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = LoanStatus, y = BorrowerAPR))+
geom_boxplot()+
coord_flip()+
xlab("Borrower's annual percentage rate (APR)")+
ylab("Loan Status")+
ggtitle("Borrower's APR distribution with different loan status")+
Theme1
df$LoanStatus <- as.factor(df$LoanStatus)
ggplot(df[!is.na(df$BorrowerAPR), ],
aes(x = LoanStatus, y = BorrowerAPR))+
geom_boxplot()+
coord_flip()+
ylab("Borrower's annual percentage rate (APR)")+
xlab("Loan Status")+
ggtitle("Borrower's APR distribution with different loan status")+
Theme1
new_df2 <- new_df[!is.na(new_df$ProsperScore) &
!is.na(new_df$CreditScore), ]
new_df2$CreditScore2 <- cut2(new_df2$CreditScore, g = 20)
new_df2$ProsperScore2 <- cut2(new_df2$ProsperScore, g = 20)
new_df3 <- new_df2 %>% group_by(CreditScore2, ProsperScore2) %>%
summarise(good_debt_ratio =
ratio(LoanStatus2,
"Good_debt"))
ggplot(new_df3,
aes(x=CreditScore2,y=ProsperScore2))+
geom_tile(aes(fill = good_debt_ratio))+
scale_fill_gradient(low = "black", high = "yellow")+
xlab("Credit score splitted into 11 quantile groups")+
ylab("Prosper score, from 1 (lowest) to 11")+
ggtitle("Heat map of CreditScore and ProsperScore")+
scale_fill_continuous(guide = guide_legend(title = "good debts / all depts"))+
Theme1
new_df2 <- new_df[!is.na(new_df$ProsperScore) &
!is.na(new_df$CreditScore), ]
new_df2$CreditScore2 <- cut2(new_df2$CreditScore, g = 20)
new_df2$ProsperScore2 <- cut2(new_df2$ProsperScore, g = 20)
new_df3 <- new_df2 %>% group_by(CreditScore2, ProsperScore2) %>%
summarise(good_debt_ratio =
ratio(LoanStatus2,
"Good_debt"))
ggplot(new_df3,
aes(x=CreditScore2,y=ProsperScore2))+
geom_tile(aes(fill = good_debt_ratio))+
scale_fill_gradient(low = "black", high = "yellow")+
xlab("Credit score splitted into 11 quantile groups")+
ylab("Prosper score, from 1 (lowest) to 11")+
ggtitle("Heat map of CreditScore and ProsperScore")+
scale_fill_continuous(guide = guide_legend(title = "good debts / all depts"))+
Theme1
new_df2 <- new_df[!is.na(new_df$ProsperScore) &
!is.na(new_df$CreditScore), ]
new_df2$CreditScore2 <- cut2(new_df2$CreditScore, g = 20)
new_df2$ProsperScore2 <- cut2(new_df2$ProsperScore, g = 20)
new_df3 <- new_df2 %>% group_by(CreditScore2, ProsperScore2) %>%
summarise(good_debt_ratio =
ratio(LoanStatus2,
"Good_debt"))
ggplot(new_df3,
aes(x=CreditScore2,y=ProsperScore2))+
geom_tile(aes(fill = good_debt_ratio))+
scale_fill_gradient(low = "black", high = "yellow")+
xlab("Credit score splitted into 11 quantile groups")+
ylab("Prosper score, from 1 (lowest) to 11")+
ggtitle("Heat map of CreditScore and ProsperScore")+
#scale_fill_continuous(guide = guide_legend(title = "good debts / all depts"))+
Theme1
new_df2 <- new_df[!is.na(new_df$ProsperScore) &
!is.na(new_df$CreditScore), ]
new_df2$CreditScore2 <- cut2(new_df2$CreditScore, g = 20)
new_df2$ProsperScore2 <- cut2(new_df2$ProsperScore, g = 20)
new_df3 <- new_df2 %>% group_by(CreditScore2, ProsperScore2) %>%
summarise(good_debt_ratio =
ratio(LoanStatus2,
"Good_debt"))
ggplot(new_df3,
aes(x=CreditScore2,y=ProsperScore2))+
geom_tile(aes(fill = good_debt_ratio))+
scale_fill_gradient(low = "black", high = "yellow")+
xlab("Credit score splitted into 11 quantile groups")+
ylab("Prosper score, from 1 (lowest) to 11")+
ggtitle("Heat map of CreditScore and ProsperScore")+
guides(fill = guide_legend(title = "LEFT", title.position = "left"))+
Theme1
new_df2 <- new_df[!is.na(new_df$ProsperScore) &
!is.na(new_df$CreditScore), ]
new_df2$CreditScore2 <- cut2(new_df2$CreditScore, g = 20)
new_df2$ProsperScore2 <- cut2(new_df2$ProsperScore, g = 20)
new_df3 <- new_df2 %>% group_by(CreditScore2, ProsperScore2) %>%
summarise(good_debt_ratio =
ratio(LoanStatus2,
"Good_debt"))
ggplot(new_df3,
aes(x=CreditScore2,y=ProsperScore2))+
geom_tile(aes(fill = good_debt_ratio))+
scale_fill_gradient(low = "black", high = "yellow")+
xlab("Credit score splitted into 11 quantile groups")+
ylab("Prosper score, from 1 (lowest) to 11 (highest)")+
ggtitle("Heat map of CreditScore and ProsperScore")+
guides(fill = guide_legend(title = "good debt / all debt", title.position = "top"))+
Theme1
new_df2 <- new_df[!is.na(new_df$ProsperScore) &
!is.na(new_df$CreditScore), ]
new_df2$CreditScore2 <- cut2(new_df2$CreditScore, g = 20)
new_df2$ProsperScore2 <- cut2(new_df2$ProsperScore, g = 20)
new_df3 <- new_df2 %>% group_by(CreditScore2, ProsperScore2) %>%
summarise(good_debt_ratio =
ratio(LoanStatus2,
"Good_debt"))
ggplot(new_df3,
aes(x=CreditScore2,y=ProsperScore2))+
geom_tile(aes(fill = good_debt_ratio))+
scale_fill_gradient(low = "black", high = "yellow")+
xlab("Credit score splitted into 11 quantile groups")+
ylab("Prosper score, from 1 (lowest) to 11 (highest)")+
ggtitle("Heat map of credit score and prosper score, by good debt / all debt ratio")+
guides(fill = guide_legend(title = "good debt / all debt", title.position = "top"))+
Theme1
new_df$Term <- as.factor(new_df$Term)
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
ggtitle("Good debt / bad debt ratio plot by term length")+
ylab("Good debt ratio")+
Theme1
new_df$Term <- as.factor(new_df$Term)
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
xlab("Term length in months")+
ylab("Good debt / all debt ratio")
ggtitle("Good debt / all debt ratio plot by term length")+
guides(fill = guide_legend(title = "loan status", title.position = "top"))+
Theme1
new_df$Term <- as.factor(new_df$Term)
ggplot(new_df,
aes(x = Term, fill = LoanStatus2))+
geom_bar(position =  "fill")+
xlab("Term length in months")+
ylab("Good debt / all debt ratio")+
ggtitle("Good debt / all debt ratio plot by term length")+
guides(fill = guide_legend(title = "loan status", title.position = "top"))+
Theme1
